<?xml version ="1.0"?>
<robot xmlns:xacro="http://ros.org/wiki/xacro" name="mobile_robot">

    <link name="robot_body">
        <visual>
            <!-- rpy is for roll pitch yaw which are the euler angles that specify orientation-->
            <origin rpy= "0 0 0" xyz= "0 0 0"/>
            <geometry>
            <!-- size of the body, which is a box -->
                <box size="1 0.6 0.3" />
            </geometry>

            <material name="red">
                <color rgba="1 0 0 1"/>
            </material>
        </visual>
        <collision>
            <origin rpy= "0 0 0" xyz= "0 0 0"/>
            <geometry>
                <box size="1 0.6 0.3" />
            </geometry>
        </collision>
        <!-- using the mass of the chasis as 1.0 kg and constructing the moment of inertia tensor based on a solid cuboid-->
        <inertial> 
            <mass value="1.0"/>
            <!-- specify upper triangle -->
            <inertia ixx="0.0375" iyy="0.113333333" izz="0.0908333333"
                     ixy="0"      ixz="0"           iyz="0"
            />

        </inertial>
    </link>

    <xacro:macro name="wheels" params="prefix joint_x joint_y joint_z">
        <xacro:property name ="length" value="0.1"/>
        <xacro:property name = "radius" value="0.15"/>
        <xacro:property name = "mass" value="0.1"/>
           
        <link name="${prefix}_link">
            <visual>
            <!-- origin of the coordinate system attached to the centre of mass 
            is rotated 1.570795 radiants around the roll axis (x axis).
            Means that the cylinder defining the wheel is rotated around the x-axis
            to place the cylinder in the correct position.-->
                <!-- <origin rpy="1.570795 0 0" xyz="0 0 0"/> -->
                <geometry>
                <!--The wheel is a cylinder with radius of 0.15 and with the length of 0.1.-->
                    <cylinder length="${length}" radius="${radius}" />
                </geometry>

                <material name="yellow">
                    <color rgba="1 1 0 1"/>
                </material>
            </visual>
            <collision>
                <origin rpy="1.570795 0 0" xyz="0 0 0"/>
                <geometry>
                    <cylinder length="${length}" radius="${radius}" />
                </geometry>
            </collision>
            <inertial> 
                <mass value="${mass}"/>
                <!-- specify upper triangle -->
                <inertia ixx="${1/12*mass*(3*radius**2+length**2)}" iyy="${1/12*mass*(3*radius**2+length**2)}" izz="${1/2*mass*radius**2}"
                        ixy="0"      ixz="0"           iyz="0"/>

            </inertial>
        </link>
        <!-- continuous type so that the wheel can continuously rotate with respect to the robot base. -->   
        <joint name="${prefix}_joint" type="continuous">
            <parent link="robot_body"/>
            <child link="${prefix}_link"/>
            <origin xyz="${joint_x} ${joint_y} ${joint_z}" rpy="0 0 0"/>
            <!-- axis of rotation around y axis -->
            <axis xyz="0 1 0"/> 
        </joint> 

    </xacro:macro>
    <!--left upper wheel -->
    <xacro:wheels prefix="wheel_left_upper" joint_x="0.3" joint_y="0.35" joint_z="-0.1"/>
    <!--left lower wheel -->
    <xacro:wheels prefix="wheel_left_lower" joint_x="-0.3" joint_y="0.35" joint_z="-0.1"/>
    <!--right upper wheel -->
    <xacro:wheels prefix="wheel_right_upper" joint_x="0.3" joint_y="-0.35" joint_z="-0.1"/>
    <!--right lower wheel-->
    <xacro:wheels prefix="wheel_right_lower" joint_x="-0.3" joint_y="-0.35" joint_z="-0.1"/>


</robot>